{
  "variables": {
  },
  "builders": [
    {
      "type": "arm-image",
      "iso_url": "https://downloads.raspberrypi.com/raspios_lite_armhf/images/raspios_lite_armhf-2024-07-04/2024-07-04-raspios-bookworm-armhf-lite.img.xz",
      "iso_checksum": "sha256:df9c192d66d35e1ce67acde33a5b5f2b81ff02d2b986ea52f1f6ea211d646a1b"
    }
  ],
  "provisioners": [
    {
      "type": "shell",
      "inline": [
        "echo 'Install APT Packages'",
        "echo nameserver 8.8.8.8 > /etc/resolv.conf",
        "apt-get update",
        "apt-get dist-upgrade",
        "apt-get install cups cockpit cockpit-networkmanager network-manager openssh-server avahi-daemon libnss-mdns",
        "usermod -a -G lpadmin pi"
      ]
    },
    {
      "type":"file",
      "source":"./scripts/avahi-daemon.conf",
      "destination":"/etc/avahi/avahi-daemon.conf"
    },
    {
      "type":"shell",
      "inline":[
        "systemctl restart avahi-daemon.service",
        "systemctl enable cups.service cups.socket cups.path"
      ]
    },
    {
      "type":"file",
      "source":"./scripts/cupsd.conf",
      "destination":"/etc/cups/cupsd.conf"
    },
    {
      "type":"shell",
      "inline":[
        "systemctl restart cups.service cups.socket cups.path",
        "systemctl enable cups.service cups.socket cups.path"
      ]
    }
  ]
}
